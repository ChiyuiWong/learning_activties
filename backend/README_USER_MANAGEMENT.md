# ğŸ“ COMP5241 ç”¨æˆ·ç®¡ç†æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬ç³»ç»Ÿä½¿ç”¨MongoDBæ•°æ®åº“æ¥ç®¡ç†ç”¨æˆ·è´¦å·ï¼Œæ”¯æŒå®‰å…¨çš„å¯†ç åŠ å¯†å’Œè§’è‰²ç®¡ç†ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è®¾ç½®MongoDBæ•°æ®åº“

```bash
# è¿›å…¥åç«¯ç›®å½•
cd learning_activties/backend

# å®‰è£…ä¾èµ–
pip install pymongo python-dotenv bcrypt cryptography

# è®¾ç½®æ•°æ®åº“
python setup_mongodb.py

# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
python setup_mongodb.py check
```

### 2. ç®¡ç†ç”¨æˆ·è´¦å·

```bash
# è¿è¡Œç”¨æˆ·ç®¡ç†å·¥å…·
python create_users.py
```

## ğŸ”§ ç”¨æˆ·ç®¡ç†å·¥å…·åŠŸèƒ½

### ä¸»èœå•é€‰é¡¹ï¼š

1. **ğŸ“ åˆ›å»ºæ¿€æ´»ç ** - æ ‡å‡†çš„ä¸¤æ­¥æ³¨å†Œæµç¨‹
2. **ğŸ‘¤ ç›´æ¥åˆ›å»ºç”¨æˆ·** - ç®¡ç†å‘˜ç›´æ¥åˆ›å»ºè´¦å·
3. **ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·** - åˆ—å‡ºç°æœ‰ç”¨æˆ·
4. **ğŸ”‘ æŸ¥çœ‹æ‰€æœ‰æ¿€æ´»ç ** - åˆ—å‡ºå¾…æ¿€æ´»çš„è´¦å·
5. **ğŸš€ åˆ›å»ºæ¼”ç¤ºç”¨æˆ·** - ä¸€é”®åˆ›å»ºæµ‹è¯•è´¦å·
6. **âŒ é€€å‡º**

## ğŸ“ åˆ›å»ºç”¨æˆ·çš„ä¸¤ç§æ–¹å¼

### æ–¹å¼1: ä¸¤æ­¥æ³¨å†Œæµç¨‹ï¼ˆæ¨èï¼‰

**ç¬¬ä¸€æ­¥ï¼šç®¡ç†å‘˜åˆ›å»ºæ¿€æ´»ç **
```bash
python create_users.py
# é€‰æ‹© 1 - åˆ›å»ºæ¿€æ´»ç 
# è¾“å…¥ï¼šé‚®ç®±ã€å§“åã€è§’è‰²
# è·å¾—ï¼šæ¿€æ´»ç  (UUID)
```

**ç¬¬äºŒæ­¥ï¼šç”¨æˆ·ä½¿ç”¨æ¿€æ´»ç æ³¨å†Œ**
- ç”¨æˆ·è®¿é—®æ³¨å†Œé¡µé¢
- è¾“å…¥æ¿€æ´»ç ã€ç”¨æˆ·åã€å¯†ç 
- ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºè´¦å·

### æ–¹å¼2: ç›´æ¥åˆ›å»ºç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰

```bash
python create_users.py
# é€‰æ‹© 2 - ç›´æ¥åˆ›å»ºç”¨æˆ·
# è¾“å…¥ï¼šç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ã€å§“åã€è§’è‰²
# ç«‹å³åˆ›å»ºè´¦å·
```

## ğŸ‘¥ ç”¨æˆ·è§’è‰²

- **student** - å­¦ç”Ÿï¼šå¯ä»¥å‚ä¸å­¦ä¹ æ´»åŠ¨
- **teacher** - æ•™å¸ˆï¼šå¯ä»¥åˆ›å»ºå’Œç®¡ç†å­¦ä¹ æ´»åŠ¨
- **admin** - ç®¡ç†å‘˜ï¼šæ‹¥æœ‰æ‰€æœ‰æƒé™

## ğŸ” å®‰å…¨ç‰¹æ€§

### å¯†ç å®‰å…¨
- ä½¿ç”¨ bcrypt è¿›è¡Œå¯†ç å“ˆå¸Œ
- ä½¿ç”¨ AES åŠ å¯†å­˜å‚¨å¯†ç å“ˆå¸Œ
- æ¯ä¸ªå¯†ç éƒ½æœ‰å”¯ä¸€çš„ç›å€¼

### æ•°æ®åŠ å¯†
- å¯†ç å“ˆå¸Œä½¿ç”¨ AES-256-CBC åŠ å¯†
- åŠ å¯†å¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†
- æ¯ä¸ªå¯†ç éƒ½æœ‰å”¯ä¸€çš„åˆå§‹åŒ–å‘é‡(IV)

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### users é›†åˆï¼ˆç”¨æˆ·è´¦å·ï¼‰
```json
{
  "_id": "username",
  "username": "username",
  "email": "user@example.com",
  "encrypted_pw_hash": "...",
  "encrypted_pw_hash_iv": "...",
  "pw_hash_salt": "...",
  "first_name": "åå­—",
  "last_name": "å§“æ°", 
  "role": "student|teacher|admin",
  "is_active": true,
  "is_verified": true,
  "created_at": "2024-01-01T00:00:00Z"
}
```

### new_users é›†åˆï¼ˆæ¿€æ´»ç ï¼‰
```json
{
  "_id": "activation-uuid",
  "email": "user@example.com",
  "first_name": "åå­—",
  "last_name": "å§“æ°",
  "role": "student|teacher|admin",
  "created_at": "2024-01-01T00:00:00Z"
}
```

## ğŸ”§ ç¯å¢ƒé…ç½®

### .env æ–‡ä»¶
```bash
# MongoDBè¿æ¥
MONGODB_URI=mongodb://localhost:27017/comp5241_g10

# å¯†ç åŠ å¯†å¯†é’¥ï¼ˆ32å­—èŠ‚base64ç¼–ç ï¼‰
PW_HASH_ENC_KEY=your_32_byte_base64_key

# JWTå¯†é’¥
JWT_SECRET_KEY=your_jwt_secret

# å…¶ä»–é…ç½®
DISABLE_AUTH=false
FLASK_ENV=development
```

## ğŸ¯ æ¼”ç¤ºè´¦å·

ç³»ç»Ÿæä¾›ä»¥ä¸‹æ¼”ç¤ºè´¦å·ç”¨äºæµ‹è¯•ï¼š

| ç”¨æˆ·å | å¯†ç  | è§’è‰² | è¯´æ˜ |
|--------|------|------|------|
| teacher1 | password123 | teacher | æ•™å¸ˆè´¦å· |
| student1 | password123 | student | å­¦ç”Ÿè´¦å· |
| admin1 | password123 | admin | ç®¡ç†å‘˜è´¦å· |
| demo | demo | teacher | é€šç”¨æ¼”ç¤ºè´¦å· |
| ä»»æ„ç”¨æˆ·å | demo | teacher | ä¸‡èƒ½æ¼”ç¤ºå¯†ç  |

## ğŸ”„ ç™»å½•ä¼˜å…ˆçº§

1. **MongoDBæ•°æ®åº“éªŒè¯**ï¼ˆä¼˜å…ˆï¼‰
2. **æ¼”ç¤ºè´¦å·éªŒè¯**ï¼ˆæ•°æ®åº“å¤±è´¥æ—¶ï¼‰
3. **ä¸‡èƒ½æ¼”ç¤ºå¯†ç **ï¼ˆæœ€åå¤‡é€‰ï¼‰

## ğŸ› ï¸ æ•…éšœæ’é™¤

### MongoDBè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥MongoDBæœåŠ¡çŠ¶æ€
# Windows
net start MongoDB

# macOS
brew services start mongodb-community

# Linux
sudo systemctl start mongod

# æ£€æŸ¥è¿æ¥
python setup_mongodb.py check
```

### å¯†é’¥é”™è¯¯
```bash
# é‡æ–°ç”ŸæˆåŠ å¯†å¯†é’¥
python -c "import os, base64; print(base64.b64encode(os.urandom(32)).decode())"

# æ›´æ–°.envæ–‡ä»¶ä¸­çš„PW_HASH_ENC_KEY
```

### ç”¨æˆ·åˆ›å»ºå¤±è´¥
- æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
- ç¡®è®¤è§’è‰²åç§°æ­£ç¡®ï¼ˆstudent/teacher/adminï¼‰
- éªŒè¯é‚®ç®±æ ¼å¼
- æ£€æŸ¥æ•°æ®åº“è¿æ¥

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. MongoDBæœåŠ¡æ˜¯å¦è¿è¡Œ
2. .envæ–‡ä»¶é…ç½®æ˜¯å¦æ­£ç¡®
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. ç”¨æˆ·æƒé™æ˜¯å¦è¶³å¤Ÿ

---

**æ³¨æ„ï¼š** åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ç¡®ä¿ï¼š
- ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
- å®šæœŸæ›´æ¢åŠ å¯†å¯†é’¥
- å¯ç”¨MongoDBèº«ä»½éªŒè¯
- ä½¿ç”¨HTTPSè¿æ¥
